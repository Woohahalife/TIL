# 2024.02.08 TIL

---

## 프록시(Proxy)
프록시는 인터넷에서 정보를 주고 받을 때 중계 역할을 하는 컴퓨터나 애플리케이션을 가리킨다. 쉽게 말해 클라이언트가 직접 웹서버나 다른 네트워크에 통신하지 않고, 프록시를 통해 다른 서비스에 간접적으로 요청할 수 있게 해주는 컴퓨터 시스템이나 응용 프로그램을 말한다.

프록시는 보안상 이유로 직접 통신할 수 없는 두 점 사이에 중계점을 두어 대리로 통신을 수행해 보안성, 성능, 안정성을 향상시킬 수 있다.

보통 웹은 클라이언트 -> 서버, 서버 -> 클라이언트 경로로 통신하며 데이터를 주고 받는다. 하지만 서비스의 규모가 커져 동일한 요청을 처리하는 규모가 커지게 되면 이는 곧 리소스 낭비 & 서버 부하로 이어지게 된다.

이를 위한 해결책 중 하나로 end point 서버에 도달하기 전에 요청을 관리하는 서버(proxy server)를 미리 배치하여 중복 요청에 대해 동일한 응답을 할 수 있다면 클라이언트에겐 빠른 요청 처리로 인한 효과적인 서비스를 제공할 수 있고, 서버의 부하를 줄이는 효과를 낼 수 있다.

프록시 서버의 네트워크 상 위치에 따라 2가지로 나누어 놓은 유형을 알아보자

### 포워드 프록시(Forward Proxy)
![](https://velog.velcdn.com/images/chlrjs132/post/1e6d45e7-cab0-41bc-8fbd-1fe0c32047f6/image.png)

(출처 : www.imperva.com)
먼저 우리가 흔히 사용하는 프록시 개념이다.

포워드 프록시의 경우 그림처럼 클라이언트 바로 뒤에 놓여 있다.

클라이언트가 다이렉트로 서버에 접근하는 것이 아닌 중계 역할을 해주는 프록시라는 서버가 요청을 받아 인터넷을 통해 외부 서버에서 데이터를 가져와 데이터를 송신한다. 즉 클라이언트는 내부망에서 타겟 서버의 주소를 포워드 프록시에 전달하고 포워드 프록시에 인터넷으로 요청된 내용을 가져오는 방식이다.

예를 들어 클라이언트가 google.com에 연결하려고 하면 클라이언트 PC가 직접 연결하는게 아니라 포워드 프록시 서버가 대신 요청을 받아 google.com 리소스를 인터넷을 통해 대신 받아서 클라이언트에게 전달(forward) 해준다.

End Point 서버 입장에서는 프록시 서버를 통해 데이터 요청을 했기 때문에 프록시 서버를 뒤지지 않는 이상 어떠한 클라이언트가 통신을 하였는지 모른다.(사용자 숨김)

### 리버스 프록시

![](https://velog.velcdn.com/images/chlrjs132/post/15f91e54-bcf0-48f8-aa19-c14a5c969e0f/image.png)

(출처 : www.imperva.com)
리버스 프록시는 위 그림처럼 프록시 서버가 인터넷과 웹서버 사이에 놓여져있다.

클라이언트는 웹서비스에 접근할 때 인터넷을 통해 웹서버에 직접 요청하는 것이 아닌, 프록시로 요청하고 프록시가 내부망에서 배후(reverse)에 있는 서버(본래 통신하고자 하는 서버)와 통신해 데이터를 가져온 후 클라이언트에게 전달한다.

리버스 프록시를 사용함으로서 대량의 트래픽을 중간에서 관리하도록 두어 특정 서버가 과부하 되지 않게 로드 밸런싱이 가능하다.

또한 리버스 프록시를 사용하면 본해의 IP주소를 노출시키지 않을 수 있다. 클라이언트는 인터넷을 통해 리버스 프록시 url을 통해서만 서비스를 이용하게 되고 본서버의 url은 숨길 수 있어 클라이언트는 본 서버에 대한 정보를 알 수 없다.

![](https://velog.velcdn.com/images/chlrjs132/post/17a2db64-16fa-4589-82ea-8ed0563e760d/image.png)

(출처 : lessif.com)
보통 기업에서 리버스 프록시를 보안 목적으로 많이 사용한다고 한다. 기업의 네트워크 환경에서는 내부 네트워크와 외부 네트워크 사이에 **DMZ**라고 부르는 구간이 존재하는데 이 구간에 외부에 서비스를 제공하는 서버(메일 서버, 웹서버, DNS 서버)를 배치해 리버스 프록시로 설정하고 방화벽을 구축해 네트워크를 보호한다고 한다.

> WAS를 DMZ에 놓고 서비스해도 되지만 이런 서비스는 보통 내부 DBMS 서버와 연결되어 있어 WAS가 털릴 경우 DBMS와 관련 서버까지 모두 털리는 문제가 발생할 수 있다고 한다.